var UPNG={toRGBA8:function(e){var r=e.width,t=e.height;if(null==e.tabs.acTL)return[UPNG.toRGBA8.decodeImage(e.data,r,t,e).buffer];var n=[];null==e.frames[0].data&&(e.frames[0].data=e.data);for(var a=r*t*4,i=new Uint8Array(a),f=new Uint8Array(a),o=new Uint8Array(a),l=0;l<e.frames.length;l++){var s=e.frames[l],c=s.rect.x,u=s.rect.y,d=s.rect.width,h=s.rect.height,U=UPNG.toRGBA8.decodeImage(s.data,d,h,e);if(0!=l)for(var v=0;v<a;v++)o[v]=i[v];if(0==s.blend?UPNG._copyTile(U,d,h,i,r,t,c,u,0):1==s.blend&&UPNG._copyTile(U,d,h,i,r,t,c,u,1),n.push(i.buffer.slice(0)),0!=s.dispose)if(1==s.dispose)UPNG._copyTile(f,d,h,i,r,t,c,u,0);else if(2==s.dispose)for(v=0;v<a;v++)i[v]=o[v]}return n}};UPNG.toRGBA8.decodeImage=function(e,r,t,n){var a=r*t,i=UPNG.decode._getBPP(n),f=Math.ceil(r*i/8),o=new Uint8Array(4*a),l=new Uint32Array(o.buffer),s=n.ctype,c=n.depth,u=UPNG._bin.readUshort;Date.now();if(6==s){var d=a<<2;if(8==c)for(var h=0;h<d;h+=4)o[h]=e[h],o[h+1]=e[h+1],o[h+2]=e[h+2],o[h+3]=e[h+3];if(16==c)for(h=0;h<d;h++)o[h]=e[h<<1]}else if(2==s){i=n.tabs.tRNS;if(null==i){if(8==c)for(h=0;h<a;h++){var U=3*h;l[h]=255<<24|e[U+2]<<16|e[U+1]<<8|e[U]}if(16==c)for(h=0;h<a;h++){U=6*h;l[h]=255<<24|e[U+4]<<16|e[U+2]<<8|e[U]}}else{var v=i[0],g=i[1],N=i[2];if(8==c)for(h=0;h<a;h++){var P=h<<2,U=3*h;l[h]=255<<24|e[U+2]<<16|e[U+1]<<8|e[U],e[U]==v&&e[U+1]==g&&e[U+2]==N&&(o[P+3]=0)}if(16==c)for(h=0;h<a;h++){P=h<<2,U=6*h;l[h]=255<<24|e[U+4]<<16|e[U+2]<<8|e[U],u(e,U)==v&&u(e,U+2)==g&&u(e,U+4)==N&&(o[P+3]=0)}}}else if(3==s){var p=n.tabs.PLTE,G=n.tabs.tRNS,b=G?G.length:0;if(1==c)for(var w=0;w<t;w++)for(var y=w*f,m=w*r,h=0;h<r;h++){var P=m+h<<2,A=3*(_=e[y+(h>>3)]>>7-((7&h)<<0)&1);o[P]=p[A],o[P+1]=p[A+1],o[P+2]=p[A+2],o[P+3]=_<b?G[_]:255}if(2==c)for(w=0;w<t;w++)for(y=w*f,m=w*r,h=0;h<r;h++){P=m+h<<2,A=3*(_=e[y+(h>>2)]>>6-((3&h)<<1)&3);o[P]=p[A],o[P+1]=p[A+1],o[P+2]=p[A+2],o[P+3]=_<b?G[_]:255}if(4==c)for(w=0;w<t;w++)for(y=w*f,m=w*r,h=0;h<r;h++){P=m+h<<2,A=3*(_=e[y+(h>>1)]>>4-((1&h)<<2)&15);o[P]=p[A],o[P+1]=p[A+1],o[P+2]=p[A+2],o[P+3]=_<b?G[_]:255}if(8==c)for(h=0;h<a;h++){var _,P=h<<2,A=3*(_=e[h]);o[P]=p[A],o[P+1]=p[A+1],o[P+2]=p[A+2],o[P+3]=_<b?G[_]:255}}else if(4==s){if(8==c)for(h=0;h<a;h++){var P=h<<2,H=e[I=h<<1];o[P]=H,o[P+1]=H,o[P+2]=H,o[P+3]=e[I+1]}if(16==c)for(h=0;h<a;h++){var I,P=h<<2,H=e[I=h<<2];o[P]=H,o[P+1]=H,o[P+2]=H,o[P+3]=e[I+2]}}else if(0==s)for(v=n.tabs.tRNS||-1,w=0;w<t;w++){var M=w*f,q=w*r;if(1==c)for(var T=0;T<r;T++){var R=(H=255*(e[M+(T>>>3)]>>>7-(7&T)&1))==255*v?0:255;l[q+T]=R<<24|H<<16|H<<8|H}else if(2==c)for(T=0;T<r;T++){R=(H=85*(e[M+(T>>>2)]>>>6-((3&T)<<1)&3))==85*v?0:255;l[q+T]=R<<24|H<<16|H<<8|H}else if(4==c)for(T=0;T<r;T++){R=(H=17*(e[M+(T>>>1)]>>>4-((1&T)<<2)&15))==17*v?0:255;l[q+T]=R<<24|H<<16|H<<8|H}else if(8==c)for(T=0;T<r;T++){R=(H=e[M+T])==v?0:255;l[q+T]=R<<24|H<<16|H<<8|H}else if(16==c)for(T=0;T<r;T++){H=e[M+(T<<1)],R=u(e,M+(T<<1))==v?0:255;l[q+T]=R<<24|H<<16|H<<8|H}}return o},UPNG.decode=function(e){for(var r,t=new Uint8Array(e),n=8,a=UPNG._bin,i=a.readUshort,f=a.readUint,o={tabs:{},frames:[]},l=new Uint8Array(t.length),s=0,c=0,u=[137,80,78,71,13,10,26,10],d=0;d<8;d++)if(t[d]!=u[d])throw"The input is not a PNG file!";for(;n<t.length;){var h=a.readUint(t,n);n+=4;var U,v=a.readASCII(t,n,4);if(n+=4,"IHDR"==v)UPNG.decode._IHDR(t,n,o);else if("CgBI"==v)o.tabs[v]=t.slice(n,n+4);else if("IDAT"==v){for(d=0;d<h;d++)l[s+d]=t[n+d];s+=h}else if("acTL"==v)o.tabs[v]={num_frames:f(t,n),num_plays:f(t,n+4)},r=new Uint8Array(t.length);else if("fcTL"==v){0!=c&&((U=o.frames[o.frames.length-1]).data=UPNG.decode._decompress(o,r.slice(0,c),U.rect.width,U.rect.height),c=0);var g={x:f(t,n+12),y:f(t,n+16),width:f(t,n+4),height:f(t,n+8)},N=i(t,n+22),N=i(t,n+20)/(0==N?100:N),g={rect:g,delay:Math.round(1e3*N),dispose:t[n+24],blend:t[n+25]};o.frames.push(g)}else if("fdAT"==v){for(d=0;d<h-4;d++)r[c+d]=t[n+d+4];c+=h-4}else if("pHYs"==v)o.tabs[v]=[a.readUint(t,n),a.readUint(t,n+4),t[n+8]];else if("cHRM"==v){o.tabs[v]=[];for(d=0;d<8;d++)o.tabs[v].push(a.readUint(t,n+4*d))}else if("tEXt"==v||"zTXt"==v){null==o.tabs[v]&&(o.tabs[v]={});var P=a.nextZero(t,n),p=a.readASCII(t,n,P-n),G=n+h-P-1;b="tEXt"==v?a.readASCII(t,P+1,G):(w=UPNG.decode._inflate(t.slice(P+2,P+2+G)),a.readUTF8(w,0,w.length)),o.tabs[v][p]=b}else if("iTXt"==v){null==o.tabs[v]&&(o.tabs[v]={});P=0,N=n;P=a.nextZero(t,N);p=a.readASCII(t,N,P-N),g=t[N=P+1],t[N+1];N+=2,P=a.nextZero(t,N);a.readASCII(t,N,P-N);P=a.nextZero(t,N=P+1);a.readUTF8(t,N,P-N);var b,w,G=h-((N=P+1)-n);b=0==g?a.readUTF8(t,N,G):(w=UPNG.decode._inflate(t.slice(N,N+G)),a.readUTF8(w,0,w.length)),o.tabs[v][p]=b}else if("PLTE"==v)o.tabs[v]=a.readBytes(t,n,h);else if("hIST"==v){var y=o.tabs.PLTE.length/3;o.tabs[v]=[];for(d=0;d<y;d++)o.tabs[v].push(i(t,n+2*d))}else if("tRNS"==v)3==o.ctype?o.tabs[v]=a.readBytes(t,n,h):0==o.ctype?o.tabs[v]=i(t,n):2==o.ctype&&(o.tabs[v]=[i(t,n),i(t,n+2),i(t,n+4)]);else if("gAMA"==v)o.tabs[v]=a.readUint(t,n)/1e5;else if("sRGB"==v)o.tabs[v]=t[n];else if("bKGD"==v)0==o.ctype||4==o.ctype?o.tabs[v]=[i(t,n)]:2==o.ctype||6==o.ctype?o.tabs[v]=[i(t,n),i(t,n+2),i(t,n+4)]:3==o.ctype&&(o.tabs[v]=t[n]);else if("IEND"==v)break;n+=h;a.readUint(t,n);n+=4}return 0!=c&&((U=o.frames[o.frames.length-1]).data=UPNG.decode._decompress(o,r.slice(0,c),U.rect.width,U.rect.height)),o.data=UPNG.decode._decompress(o,l,o.width,o.height),delete o.compress,delete o.interlace,delete o.filter,o},UPNG.decode._decompress=function(e,r,t,n){Date.now();var a=UPNG.decode._getBPP(e),a=Math.ceil(t*a/8),a=new Uint8Array((a+1+e.interlace)*n);r=e.tabs.CgBI?UPNG.inflateRaw(r,a):UPNG.decode._inflate(r,a);Date.now();return 0==e.interlace?r=UPNG.decode._filterZero(r,e,0,t,n):1==e.interlace&&(r=UPNG.decode._readInterlace(r,e)),r},UPNG.decode._inflate=function(e,r){return UPNG.inflateRaw(new Uint8Array(e.buffer,2,e.length-6),r)},UPNG.inflateRaw=function(){var e,r,R={H:{}};return R.H.N=function(e,r){var t,n=Uint8Array,a=0,i=0,f=0,o=0,l=0;if(3==e[0]&&0==e[1])return r||new n(0);var s=R.H,c=s.b,u=s.e,d=s.R,h=s.n,U=s.A,v=s.Z,g=s.m,N=null==r;for(N&&(r=new n(e.length>>>2<<5));0==a;)if(a=c(e,l,1),t=c(e,l+1,2),l+=3,0!=t){if(N&&(r=R.H.W(r,o+(1<<17))),1==t&&(m=g.J,A=g.h,i=511,f=31),2==t){for(var P=u(e,l,5)+257,p=u(e,l+5,5)+1,G=u(e,l+10,4)+4,b=(l+=14,1),w=0;w<38;w+=2)g.Q[w]=0,g.Q[w+1]=0;for(w=0;w<G;w++){var y=u(e,l+3*w,3);b<(g.Q[1+(g.X[w]<<1)]=y)&&(b=y)}l+=3*G,h(g.Q,b),U(g.Q,b,g.u);var m=g.w,A=g.d,l=d(g.u,(1<<b)-1,P+p,e,l,g.v),_=s.V(g.v,0,P,g.C),i=(1<<_)-1,H=s.V(g.v,P,p,g.D),f=(1<<H)-1;h(g.C,_),U(g.C,_,m),h(g.D,H),U(g.D,H,A)}for(;;){var I=m[v(e,l)&i];l+=15&I;I=I>>>4;if(I>>>8==0)r[o++]=I;else{if(256==I)break;var M=o+I-254;264<I&&(M=o+((q=g.q[I-257])>>>3)+u(e,l,7&q),l+=7&q);var q=A[v(e,l)&f];l+=15&q;var q=g.c[q>>>4],T=(q>>>4)+c(e,l,15&q);for(l+=15&q;o<M;)r[o]=r[o++-T],r[o]=r[o++-T],r[o]=r[o++-T],r[o]=r[o++-T];o=M}}}else{0!=(7&l)&&(l+=8-(7&l));_=4+(l>>>3),H=e[_-4]|e[_-3]<<8;(r=N?R.H.W(r,o+H):r).set(new n(e.buffer,e.byteOffset+_,H),o),l=_+H<<3,o+=H}return r.length==o?r:r.slice(0,o)},R.H.W=function(e,r){var t=e.length;if(r<=t)return e;t=new Uint8Array(t<<1);return t.set(e,0),t},R.H.R=function(e,r,t,n,a,i){for(var f=R.H.e,o=R.H.Z,l=0;l<t;){var s=e[o(n,a)&r];a+=15&s;var c=s>>>4;if(c<=15)i[l]=c,l++;else{var u=0,s=0;16==c?(s=3+f(n,a,2),a+=2,u=i[l-1]):17==c?(s=3+f(n,a,3),a+=3):18==c&&(s=11+f(n,a,7),a+=7);for(var d=l+s;l<d;)i[l]=u,l++}}return a},R.H.V=function(e,r,t,n){for(var a=0,i=0,f=n.length>>>1;i<t;){var o=e[i+r];n[i<<1]=0,a<(n[1+(i<<1)]=o)&&(a=o),i++}for(;i<f;)n[i<<1]=0,n[1+(i<<1)]=0,i++;return a},R.H.n=function(e,r){for(var t,n,a,i=R.H.m,f=e.length,o=i.j,l=0;l<=r;l++)o[l]=0;for(l=1;l<f;l+=2)o[e[l]]++;var s=i.K,c=0;for(o[0]=0,t=1;t<=r;t++)c=c+o[t-1]<<1,s[t]=c;for(n=0;n<f;n+=2)0!=(a=e[n+1])&&(e[n]=s[a],s[a]++)},R.H.A=function(e,r,t){for(var n=e.length,a=R.H.m.r,i=0;i<n;i+=2)if(0!=e[i+1])for(var f=e[i+1],o=i>>1<<4|f,f=r-f,l=e[i]<<f,s=l+(1<<f);l!=s;)t[a[l]>>>15-r]=o,l++},R.H.l=function(e,r){for(var t=R.H.m.r,n=15-r,a=0;a<e.length;a+=2){var i=e[a]<<r-e[a+1];e[a]=t[i]>>>n}},R.H.M=function(e,r,t){var n=r>>>3;e[n]|=t<<=7&r,e[1+n]|=t>>>8},R.H.I=function(e,r,t){var n=r>>>3;e[n]|=t<<=7&r,e[1+n]|=t>>>8,e[2+n]|=t>>>16},R.H.e=function(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<t)-1},R.H.b=function(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<t)-1},R.H.Z=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)},R.H.i=function(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16|e[3+(r>>>3)]<<24)>>>(7&r)},R.H.m=(e=Uint16Array,r=Uint32Array,{K:new e(16),j:new e(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new e(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new e(512),_:[],h:new e(32),$:[],w:new e(32768),C:[],v:[],d:new e(32768),D:[],u:new e(512),Q:[],r:new e(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new e(65536),g:new e(32768)}),function(){for(var e=R.H.m,r=0;r<32768;r++){var t=r;e.r[r]=((t=(4278255360&(t=(4042322160&(t=(3435973836&(t=(2863311530&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8)>>>16|t<<16)>>>17}function n(e,r,t){for(;0!=r--;)e.push(0,t)}for(r=0;r<32;r++)e.q[r]=e.S[r]<<3|e.T[r],e.c[r]=e.p[r]<<4|e.z[r];n(e._,144,8),n(e._,112,9),n(e._,24,7),n(e._,8,8),R.H.n(e._,9),R.H.A(e._,9,e.J),R.H.l(e._,9),n(e.$,32,5),R.H.n(e.$,5),R.H.A(e.$,5,e.h),R.H.l(e.$,5),n(e.Q,19,0),n(e.C,286,0),n(e.D,30,0),n(e.v,320,0)}(),R.H.N}(),UPNG.decode._readInterlace=function(e,r){for(var t=r.width,n=r.height,a=UPNG.decode._getBPP(r),i=a>>3,f=Math.ceil(t*a/8),o=new Uint8Array(n*f),l=0,s=[0,0,4,0,2,0,1],c=[0,4,0,2,0,1,0],u=[8,8,8,4,4,2,2],d=[8,8,4,4,2,2,1],h=0;h<7;){for(var U=u[h],v=d[h],g=0,N=0,P=s[h];P<n;)P+=U,N++;for(var p=c[h];p<t;)p+=v,g++;var G=Math.ceil(g*a/8);UPNG.decode._filterZero(e,r,l,g,N);for(var b=0,w=s[h];w<n;){for(var y,m=c[h],A=l+b*G<<3;m<t;){if(1==a&&(y=e[A>>3],o[w*f+(m>>3)]|=(y=y>>7-(7&A)&1)<<7-((7&m)<<0)),2==a&&(y=e[A>>3],o[w*f+(m>>2)]|=(y=y>>6-(7&A)&3)<<6-((3&m)<<1)),4==a&&(y=e[A>>3],o[w*f+(m>>1)]|=(y=y>>4-(7&A)&15)<<4-((1&m)<<2)),8<=a)for(var _=w*f+m*i,H=0;H<i;H++)o[_+H]=e[(A>>3)+H];A+=a,m+=v}b++,w+=U}g*N!=0&&(l+=N*(1+G)),h+=1}return o},UPNG.decode._getBPP=function(e){return[1,null,3,1,2,null,4][e.ctype]*e.depth},UPNG.decode._filterZero=function(e,r,t,n,a){var i,f,o=UPNG.decode._getBPP(r),l=Math.ceil(n*o/8),s=UPNG.decode._paeth,o=Math.ceil(o/8),c=e[t],u=0;if(1<c&&(e[t]=[0,0,1][c-2]),3==c)for(u=o;u<l;u++)e[u+1]=e[u+1]+(e[u+1-o]>>>1)&255;for(var d=0;d<a;d++)if((u=0)==(c=e[(f=(i=t+d*l)+d+1)-1]))for(;u<l;u++)e[i+u]=e[f+u];else if(1==c){for(;u<o;u++)e[i+u]=e[f+u];for(;u<l;u++)e[i+u]=e[f+u]+e[i+u-o]}else if(2==c)for(;u<l;u++)e[i+u]=e[f+u]+e[i+u-l];else if(3==c){for(;u<o;u++)e[i+u]=e[f+u]+(e[i+u-l]>>>1);for(;u<l;u++)e[i+u]=e[f+u]+(e[i+u-l]+e[i+u-o]>>>1)}else{for(;u<o;u++)e[i+u]=e[f+u]+s(0,e[i+u-l],0);for(;u<l;u++)e[i+u]=e[f+u]+s(e[i+u-o],e[i+u-l],e[i+u-o-l])}return e},UPNG.decode._paeth=function(e,r,t){var n=e+r-t,a=n-e,i=n-r,n=n-t;return a*a<=i*i&&a*a<=n*n?e:i*i<=n*n?r:t},UPNG.decode._IHDR=function(e,r,t){var n=UPNG._bin;t.width=n.readUint(e,r),t.height=n.readUint(e,r+=4),t.depth=e[r+=4],t.ctype=e[++r],t.compress=e[++r],t.filter=e[++r],t.interlace=e[++r],r++},UPNG._bin={nextZero:function(e,r){for(;0!=e[r];)r++;return r},readUshort:function(e,r){return e[r]<<8|e[r+1]},writeUshort:function(e,r,t){e[r]=t>>8&255,e[r+1]=255&t},readUint:function(e,r){return 16777216*e[r]+(e[r+1]<<16|e[r+2]<<8|e[r+3])},writeUint:function(e,r,t){e[r]=t>>24&255,e[r+1]=t>>16&255,e[r+2]=t>>8&255,e[r+3]=255&t},readASCII:function(e,r,t){for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[r+a]);return n},writeASCII:function(e,r,t){for(var n=0;n<t.length;n++)e[r+n]=t.charCodeAt(n)},readBytes:function(e,r,t){for(var n=[],a=0;a<t;a++)n.push(e[r+a]);return n},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(r,t,n){for(var e,a="",i=0;i<n;i++)a+="%"+UPNG._bin.pad(r[t+i].toString(16));try{e=decodeURIComponent(a)}catch(e){return UPNG._bin.readASCII(r,t,n)}return e}},UPNG._copyTile=function(e,r,t,n,a,i,f,o,l){for(var s=Math.min(r,a),c=Math.min(t,i),u=0,d=0,h=0;h<c;h++)for(var U=0;U<s;U++)if(d=0<=f&&0<=o?(u=h*r+U<<2,(o+h)*a+f+U<<2):(u=(-o+h)*r-f+U<<2,h*a+U<<2),0==l)n[d]=e[u],n[d+1]=e[u+1],n[d+2]=e[u+2],n[d+3]=e[u+3];else if(1==l){var v=e[u+3]*(1/255),g=e[u]*v,N=e[u+1]*v,P=e[u+2]*v,p=n[d+3]*(1/255),G=n[d]*p,b=n[d+1]*p,w=n[d+2]*p,y=1-v,m=v+p*y,A=0==m?0:1/m;n[d+3]=255*m,n[d+0]=(g+G*y)*A,n[d+1]=(N+b*y)*A,n[d+2]=(P+w*y)*A}else if(2==l){v=e[u+3],g=e[u],N=e[u+1],P=e[u+2],p=n[d+3],G=n[d],b=n[d+1],w=n[d+2];v==p&&g==G&&N==b&&P==w?(n[d]=0,n[d+1]=0,n[d+2]=0,n[d+3]=0):(n[d]=g,n[d+1]=N,n[d+2]=P,n[d+3]=v)}else if(3==l){v=e[u+3],g=e[u],N=e[u+1],P=e[u+2],p=n[d+3],G=n[d],b=n[d+1],w=n[d+2];if((v!=p||g!=G||N!=b||P!=w)&&(v<220&&20<p))return!1}return!0},UPNG.encode=function(e,r,t,n,a,i,f){f=UPNG.encode.compress(e,r,t,n=null==n?0:n,[!1,!1,!1,0,f=null==f?!1:f,!1]);return UPNG.encode.compressPNG(f,-1),UPNG.encode._main(f,r,t,a,i)},UPNG.encodeLL=function(e,r,t,n,a,i,f,o){for(var l={ctype:0+(1==n?0:2)+(0==a?0:4),depth:i,frames:[]},s=(Date.now(),(n+a)*i),c=s*r,u=0;u<e.length;u++)l.frames.push({rect:{x:0,y:0,width:r,height:t},img:new Uint8Array(e[u]),blend:0,dispose:1,bpp:Math.ceil(s/8),bpl:Math.ceil(c/8)});return UPNG.encode.compressPNG(l,0,!0),UPNG.encode._main(l,r,t,f,o)},UPNG.encode._main=function(e,r,t,n,a){var i=UPNG.crc.crc,f=UPNG._bin.writeUint,o=UPNG._bin.writeUshort,l=UPNG._bin.writeASCII,s=8,c=1<e.frames.length,u=!1,d=33+(c?20:0);if(null!=(a=null==a?{}:a).sRGB&&(d+=13),null!=a.pHYs&&(d+=21),3==e.ctype){for(var h=e.plte.length,U=0;U<h;U++)e.plte[U]>>>24!=255&&(u=!0);d+=8+3*h+4+(u?+h+8+4:0)}for(var v=0;v<e.frames.length;v++)c&&(d+=38),d+=(y=e.frames[v]).cimg.length+12,0!=v&&(d+=4);d+=12;for(var g=new Uint8Array(d),N=[137,80,78,71,13,10,26,10],U=0;U<8;U++)g[U]=N[U];if(f(g,s,13),l(g,s+=4,"IHDR"),f(g,s+=4,r),f(g,s+=4,t),g[s+=4]=e.depth,g[++s]=e.ctype,g[++s]=0,g[++s]=0,g[++s]=0,f(g,++s,i(g,s-17,17)),s+=4,null!=a.sRGB&&(f(g,s,1),l(g,s+=4,"sRGB"),g[s+=4]=a.sRGB,f(g,++s,i(g,s-5,5)),s+=4),null!=a.pHYs&&(f(g,s,9),l(g,s+=4,"pHYs"),f(g,s+=4,a.pHYs[0]),f(g,s+=4,a.pHYs[1]),g[s+=4]=a.pHYs[2],f(g,++s,i(g,s-13,13)),s+=4),c&&(f(g,s,8),l(g,s+=4,"acTL"),f(g,s+=4,e.frames.length),f(g,s+=4,null!=a.loop?a.loop:0),f(g,s+=4,i(g,s-12,12)),s+=4),3==e.ctype){f(g,s,3*(h=e.plte.length)),l(g,s+=4,"PLTE"),s+=4;for(U=0;U<h;U++){var P=3*U,p=e.plte[U],G=p>>>8&255,b=p>>>16&255;g[s+P+0]=255&p,g[s+P+1]=G,g[s+P+2]=b}if(f(g,s+=3*h,i(g,s-3*h-4,3*h+4)),s+=4,u){f(g,s,h),l(g,s+=4,"tRNS"),s+=4;for(U=0;U<h;U++)g[s+U]=e.plte[U]>>>24&255;f(g,s+=h,i(g,s-h-4,h+4)),s+=4}}for(var w=0,v=0;v<e.frames.length;v++){var y=e.frames[v];c&&(f(g,s,26),l(g,s+=4,"fcTL"),f(g,s+=4,w++),f(g,s+=4,y.rect.width),f(g,s+=4,y.rect.height),f(g,s+=4,y.rect.x),f(g,s+=4,y.rect.y),o(g,s+=4,n[v]),o(g,s+=2,1e3),g[s+=2]=y.dispose,g[++s]=y.blend,f(g,++s,i(g,s-30,30)),s+=4);var m=y.cimg;f(g,s,(h=m.length)+(0==v?0:4));var A=s+=4;l(g,s,0==v?"IDAT":"fdAT"),s+=4,0!=v&&(f(g,s,w++),s+=4),g.set(m,s),f(g,s+=h,i(g,A,s-A)),s+=4}return f(g,s,0),l(g,s+=4,"IEND"),f(g,s+=4,i(g,s-4,4)),s+=4,g.buffer},UPNG.encode.compressPNG=function(e,r,t){for(var n=0;n<e.frames.length;n++){var a=e.frames[n],i=(a.rect.width,a.rect.height),f=new Uint8Array(i*a.bpl+i);a.cimg=UPNG.encode._filterZero(a.img,i,a.bpp,a.bpl,f,r,t)}},UPNG.encode.compress=function(e,r,t,n,a){for(var i=a[0],f=a[1],o=a[2],l=a[3],s=a[4],c=a[5],u=6,d=8,h=255,U=0;U<e.length;U++)for(var v=new Uint8Array(e[U]),g=v.length,N=0;N<g;N+=4)h&=v[N+3];var P=255!=h,p=UPNG.encode.framize(e,r,t,i,f,o),G={},b=[],w=[];if(0!=n){for(var y=[],N=0;N<p.length;N++)y.push(p[N].img.buffer);for(var o=UPNG.encode.concatRGBA(y),m=UPNG.quantize(o,n),N=0;N<m.plte.length;N++)b.push(m.plte[N].est.rgba);for(var A=0,N=0;N<p.length;N++){var _=(M=p[N]).img.length,H=new Uint8Array(m.inds.buffer,A>>2,_>>2);w.push(H);var I=new Uint8Array(m.abuf,A,_);c&&UPNG.encode.dither(M.img,M.rect.width,M.rect.height,b,I,H),M.img.set(I),A+=_}}else for(U=0;U<p.length;U++){var M=p[U],q=new Uint32Array(M.img.buffer),T=M.rect.width,g=q.length,H=new Uint8Array(g);w.push(H);for(N=0;N<g;N++){var R=q[N];if(0!=N&&R==q[N-1])H[N]=H[N-1];else if(T<N&&R==q[N-T])H[N]=H[N-T];else{var D=G[R];if(null==D&&(G[R]=D=b.length,b.push(R),300<=b.length))break;H[N]=D}}}var z=b.length;z<=256&&0==s&&(d=z<=2?1:z<=4?2:z<=16?4:8,d=Math.max(d,l));for(U=0;U<p.length;U++){(M=p[U]).rect.x,M.rect.y;var T=M.rect.width,x=M.rect.height,B=M.img,C=(new Uint32Array(B.buffer),4*T),S=4;if(z<=256&&0==s){for(var C=Math.ceil(d*T/8),L=new Uint8Array(C*x),Z=w[U],E=0;E<x;E++){var N=E*C,F=E*T;if(8==d)for(var Y=0;Y<T;Y++)L[N+Y]=Z[F+Y];else if(4==d)for(Y=0;Y<T;Y++)L[N+(Y>>1)]|=Z[F+Y]<<4-4*(1&Y);else if(2==d)for(Y=0;Y<T;Y++)L[N+(Y>>2)]|=Z[F+Y]<<6-2*(3&Y);else if(1==d)for(Y=0;Y<T;Y++)L[N+(Y>>3)]|=Z[F+Y]<<7-(7&Y)}B=L,u=3,S=1}else if(0==P&&1==p.length){for(var L=new Uint8Array(T*x*3),k=T*x,N=0;N<k;N++){var Q=3*N,X=4*N;L[Q]=B[X],L[1+Q]=B[1+X],L[2+Q]=B[2+X]}B=L,u=2,C=(S=3)*T}M.img=B,M.bpl=C,M.bpp=S}return{ctype:u,depth:d,plte:b,frames:p}},UPNG.encode.framize=function(e,r,t,n,a,i){for(var f,o,l,s,c=[],u=0;u<e.length;u++){var d,h=new Uint8Array(e[u]),U=new Uint32Array(h.buffer),v=0,g=0,N=r,P=t,p=n?1:0;if(0!=u){for(var G=i||n||1==u||0!=c[u-2].dispose?1:2,b=0,w=1e9,y=0;y<G;y++){for(var m=new Uint8Array(e[u-1-y]),A=new Uint32Array(e[u-1-y]),_=r,H=t,I=-1,M=-1,q=0;q<t;q++)for(var T=0;T<r;T++)U[z=q*r+T]!=A[z]&&(T<_&&(_=T),I<T&&(I=T),q<H&&(H=q),M<q&&(M=q));-1==I&&(_=H=I=M=0),a&&(1==(1&_)&&_--,1==(1&H)&&H--);var R=(I-_+1)*(M-H+1);R<w&&(w=R,b=y,N=I-(v=_)+1,P=M-(g=H)+1)}m=new Uint8Array(e[u-1-b]);1==b&&(c[u-1].dispose=2),d=new Uint8Array(N*P*4),UPNG._copyTile(m,r,t,d,N,P,-v,-g,0),1==(p=UPNG._copyTile(h,r,t,d,N,P,-v,-g,3)?1:0)?UPNG.encode._prepareDiff(h,r,t,d,{x:v,y:g,width:N,height:P}):UPNG._copyTile(h,r,t,d,N,P,-v,-g,0)}else d=h.slice(0);c.push({rect:{x:v,y:g,width:N,height:P},img:d,blend:p,dispose:0})}if(n)for(u=0;u<c.length;u++)1!=(D=c[u]).blend&&(f=D.rect,o=c[u-1].rect,s={x:l=Math.min(f.x,o.x),y:s=Math.min(f.y,o.y),width:Math.max(f.x+f.width,o.x+o.width)-l,height:Math.max(f.y+f.height,o.y+o.height)-s},u-(c[u-1].dispose=1)!=0&&UPNG.encode._updateFrame(e,r,t,c,u-1,s,a),UPNG.encode._updateFrame(e,r,t,c,u,s,a));var D;if(1!=e.length)for(var z=0;z<c.length;z++)(D=c[z]).rect.width,D.rect.height;return c},UPNG.encode._updateFrame=function(e,r,t,n,a,i,f){for(var o=Uint8Array,l=Uint32Array,s=new o(e[a-1]),c=new l(e[a-1]),u=a+1<e.length?new o(e[a+1]):null,e=new o(e[a]),d=new l(e.buffer),h=r,U=t,v=-1,g=-1,N=0;N<i.height;N++)for(var P=0;P<i.width;P++){var p=i.x+P,G=i.y+N,b=G*r+p,w=d[b];0==w||0==n[a-1].dispose&&c[b]==w&&(null==u||0!=u[4*b+3])||(p<h&&(h=p),v<p&&(v=p),G<U&&(U=G),g<G&&(g=G))}-1==v&&(h=U=v=g=0),f&&(1==(1&h)&&h--,1==(1&U)&&U--);f=n[a];f.rect=i={x:h,y:U,width:v-h+1,height:g-U+1},f.blend=1,f.img=new Uint8Array(i.width*i.height*4),0==n[a-1].dispose?(UPNG._copyTile(s,r,t,f.img,i.width,i.height,-i.x,-i.y,0),UPNG.encode._prepareDiff(e,r,t,f.img,i)):UPNG._copyTile(e,r,t,f.img,i.width,i.height,-i.x,-i.y,0)},UPNG.encode._prepareDiff=function(e,r,t,n,a){UPNG._copyTile(e,r,t,n,a.width,a.height,-a.x,-a.y,2)},UPNG.encode._filterZero=function(e,r,t,n,a,i,f){var o,l=[],s=[0,1,2,3,4];-1!=i?s=[i]:(5e5<r*n||1==t)&&(s=[0]),f&&(o={level:0});for(var c=1e7<a.length&&null!=UZIP?UZIP:pako,u=(Date.now(),0);u<s.length;u++){for(var d=0;d<r;d++)UPNG.encode._filterLine(a,e,d,n,t,s[u]);l.push(c.deflate(a,o))}for(var h,U=1e9,u=0;u<l.length;u++)l[u].length<U&&(U=l[h=u].length);return l[h]},UPNG.encode._filterLine=function(e,r,t,n,a,i){var f=t*n,o=f+t,l=UPNG.decode._paeth;if(e[o]=i,o++,0==i)if(n<500)for(var s=0;s<n;s++)e[o+s]=r[f+s];else e.set(new Uint8Array(r.buffer,f,n),o);else if(1==i){for(s=0;s<a;s++)e[o+s]=r[f+s];for(s=a;s<n;s++)e[o+s]=r[f+s]-r[f+s-a]+256&255}else if(0==t){for(s=0;s<a;s++)e[o+s]=r[f+s];if(2==i)for(s=a;s<n;s++)e[o+s]=r[f+s];if(3==i)for(s=a;s<n;s++)e[o+s]=r[f+s]-(r[f+s-a]>>1)+256&255;if(4==i)for(s=a;s<n;s++)e[o+s]=r[f+s]-l(r[f+s-a],0,0)+256&255}else{if(2==i)for(s=0;s<n;s++)e[o+s]=r[f+s]+256-r[f+s-n]&255;if(3==i){for(s=0;s<a;s++)e[o+s]=r[f+s]+256-(r[f+s-n]>>1)&255;for(s=a;s<n;s++)e[o+s]=r[f+s]+256-(r[f+s-n]+r[f+s-a]>>1)&255}if(4==i){for(s=0;s<a;s++)e[o+s]=r[f+s]+256-l(0,r[f+s-n],0)&255;for(s=a;s<n;s++)e[o+s]=r[f+s]+256-l(r[f+s-a],r[f+s-n],r[f+s-a-n])&255}}},UPNG.crc={table:function(){for(var e=new Uint32Array(256),r=0;r<256;r++){for(var t=r,n=0;n<8;n++)1&t?t=3988292384^t>>>1:t>>>=1;e[r]=t}return e}(),update:function(e,r,t,n){for(var a=0;a<n;a++)e=UPNG.crc.table[255&(e^r[t+a])]^e>>>8;return e},crc:function(e,r,t){return 4294967295^UPNG.crc.update(4294967295,e,r,t)}},UPNG.quantize=function(e,r){var t=new Uint8Array(e),e=t.slice(0),n=new Uint32Array(e.buffer),r=UPNG.quantize.getKDtree(e,r),a=r[0],r=r[1],i=UPNG.quantize.planeDst,f=t.length,o=new Uint8Array(f>>2);if(t.length<2e7)for(var l=0;l<f;l+=4){var s=t[l]*(1/255),c=t[l+1]*(1/255),u=t[l+2]*(1/255),d=t[l+3]*(1/255),h=UPNG.quantize.getNearest(a,s,c,u,d);o[l>>2]=h.ind,n[l>>2]=h.est.rgba}else for(l=0;l<f;l+=4){s=t[l]*(1/255),c=t[l+1]*(1/255),u=t[l+2]*(1/255),d=t[l+3]*(1/255);for(h=a;h.left;)h=i(h.est,s,c,u,d)<=0?h.left:h.right;o[l>>2]=h.ind,n[l>>2]=h.est.rgba}return{abuf:e.buffer,inds:o,plte:r}},UPNG.quantize.getKDtree=function(e,r,t){null==t&&(t=1e-4);var n=new Uint32Array(e.buffer),a={i0:0,i1:e.length,bst:null,est:null,tdst:0,left:null,right:null};a.bst=UPNG.quantize.stats(e,a.i0,a.i1),a.est=UPNG.quantize.estats(a.bst);for(var i=[a];i.length<r;){for(var f=0,o=0,l=0;l<i.length;l++)i[l].est.L>f&&(f=i[l].est.L,o=l);if(f<t)break;var s=i[o],c=UPNG.quantize.splitPixels(e,n,s.i0,s.i1,s.est.e,s.est.eMq255);if(s.i0>=c||s.i1<=c)s.est.L=0;else{var u={i0:s.i0,i1:c,bst:null,est:null,tdst:0,left:null,right:null};u.bst=UPNG.quantize.stats(e,u.i0,u.i1),u.est=UPNG.quantize.estats(u.bst);var d={i0:c,i1:s.i1,bst:null,est:null,tdst:0,left:null,right:null};d.bst={R:[],m:[],N:s.bst.N-u.bst.N};for(l=0;l<16;l++)d.bst.R[l]=s.bst.R[l]-u.bst.R[l];for(l=0;l<4;l++)d.bst.m[l]=s.bst.m[l]-u.bst.m[l];d.est=UPNG.quantize.estats(d.bst),s.left=u,s.right=d,i[o]=u,i.push(d)}}i.sort(function(e,r){return r.bst.N-e.bst.N});for(l=0;l<i.length;l++)i[l].ind=l;return[a,i]},UPNG.quantize.getNearest=function(e,r,t,n,a){if(null==e.left)return e.tdst=UPNG.quantize.dist(e.est.q,r,t,n,a),e;var i=UPNG.quantize.planeDst(e.est,r,t,n,a),f=e.left,o=e.right;0<i&&(f=e.right,o=e.left);f=UPNG.quantize.getNearest(f,r,t,n,a);if(f.tdst<=i*i)return f;a=UPNG.quantize.getNearest(o,r,t,n,a);return a.tdst<f.tdst?a:f},UPNG.quantize.planeDst=function(e,r,t,n,a){var i=e.e;return i[0]*r+i[1]*t+i[2]*n+i[3]*a-e.eMq},UPNG.quantize.dist=function(e,r,t,n,a){r-=e[0],t-=e[1],n-=e[2],e=a-e[3];return r*r+t*t+n*n+e*e},UPNG.quantize.splitPixels=function(e,r,t,n,a,i){var f=UPNG.quantize.vecDot;n-=4;for(;t<n;){for(;f(e,t,a)<=i;)t+=4;for(;f(e,n,a)>i;)n-=4;if(n<=t)break;var o=r[t>>2];r[t>>2]=r[n>>2],r[n>>2]=o,t+=4,n-=4}for(;f(e,t,a)>i;)t-=4;return t+4},UPNG.quantize.vecDot=function(e,r,t){return e[r]*t[0]+e[r+1]*t[1]+e[r+2]*t[2]+e[r+3]*t[3]},UPNG.quantize.stats=function(e,r,t){for(var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a=[0,0,0,0],i=t-r>>2,f=r;f<t;f+=4){var o=e[f]*(1/255),l=e[f+1]*(1/255),s=e[f+2]*(1/255),c=e[f+3]*(1/255);a[0]+=o,a[1]+=l,a[2]+=s,a[3]+=c,n[0]+=o*o,n[1]+=o*l,n[2]+=o*s,n[3]+=o*c,n[5]+=l*l,n[6]+=l*s,n[7]+=l*c,n[10]+=s*s,n[11]+=s*c,n[15]+=c*c}return n[4]=n[1],n[8]=n[2],n[9]=n[6],n[12]=n[3],n[13]=n[7],n[14]=n[11],{R:n,m:a,N:i}},UPNG.quantize.estats=function(e){var r,t=e.R,n=e.m,a=e.N,i=n[0],f=n[1],o=n[2],e=n[3],n=0==a?0:1/a,t=[t[0]-i*i*n,t[1]-i*f*n,t[2]-i*o*n,t[3]-i*e*n,t[4]-f*i*n,t[5]-f*f*n,t[6]-f*o*n,t[7]-f*e*n,t[8]-o*i*n,t[9]-o*f*n,t[10]-o*o*n,t[11]-o*e*n,t[12]-e*i*n,t[13]-e*f*n,t[14]-e*o*n,t[15]-e*e*n],l=t,s=UPNG.M4,c=[Math.random(),Math.random(),Math.random(),Math.random()],u=0;if(0!=a)for(var d=0;d<16&&(c=s.multVec(l,c),r=Math.sqrt(s.dot(c,c)),c=s.sml(1/r,c),!(0!=d&&Math.abs(r-u)<1e-9));d++)u=r;n=[i*n,f*n,o*n,e*n];return{Cov:t,q:n,e:c,L:u,eMq255:s.dot(s.sml(255,n),c),eMq:s.dot(c,n),rgba:(Math.round(255*n[3])<<24|Math.round(255*n[2])<<16|Math.round(255*n[1])<<8|Math.round(255*n[0])<<0)>>>0}},UPNG.M4={multVec:function(e,r){return[e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3],e[4]*r[0]+e[5]*r[1]+e[6]*r[2]+e[7]*r[3],e[8]*r[0]+e[9]*r[1]+e[10]*r[2]+e[11]*r[3],e[12]*r[0]+e[13]*r[1]+e[14]*r[2]+e[15]*r[3]]},dot:function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]},sml:function(e,r){return[e*r[0],e*r[1],e*r[2],e*r[3]]}},UPNG.encode.concatRGBA=function(e){for(var r=0,t=0;t<e.length;t++)r+=e[t].byteLength;for(var n=new Uint8Array(r),a=0,t=0;t<e.length;t++){for(var i=new Uint8Array(e[t]),f=i.length,o=0;o<f;o+=4){var l=i[o],s=i[o+1],c=i[o+2],u=i[o+3];0==u&&(l=s=c=0),n[a+o]=l,n[a+o+1]=s,n[a+o+2]=c,n[a+o+3]=u}a+=f}return n.buffer},UPNG.encode.dither=function(e,r,t,n,a,i){function addErr(e,r,t,n){r[t]+=e[0]*n>>4,r[t+1]+=e[1]*n>>4,r[t+2]+=e[2]*n>>4,r[t+3]+=e[3]*n>>4}function N(e){return Math.max(0,Math.min(255,e))}function D(e,r){var t=e[0]-r[0],n=e[1]-r[1],a=e[2]-r[2],r=e[3]-r[3];return t*t+n*n+a*a+r*r}for(var f=n.length,o=[],l=[],s=0;s<f;s++){var c=n[s];o.push([c>>>0&255,c>>>8&255,c>>>16&255,c>>>24&255])}for(s=0;s<f;s++){for(var u=4294967295,d=0,h=0;h<f;h++){var U=D(o[s],o[h]);h!=s&&U<u&&(u=U,d=h)}var v=Math.sqrt(u)/2;l[s]=~~(v*v)}for(var g=new Uint32Array(a.buffer),P=new Int16Array(r*t*4),p=0;p<t;p++)for(var G=0;G<r;G++){for(var b=[N(e[s=4*(p*r+G)]+P[s]),N(e[s+1]+P[s+1]),N(e[s+2]+P[s+2]),N(e[s+3]+P[s+3])],d=0,w=16777215,h=0;h<f;h++){var y=D(b,o[h]);y<w&&(w=y,d=h)}var m=o[d],m=[b[0]-m[0],b[1]-m[1],b[2]-m[2],b[3]-m[3]];G!=r-1&&addErr(m,P,s+4,7),p!=t-1&&(0!=G&&addErr(m,P,s+4*r-4,3),addErr(m,P,s+4*r,5),G!=r-1&&addErr(m,P,s+4*r+4,1)),i[s>>2]=d,g[s>>2]=n[d]}};